<!DOCTYPE html>
<html>

<body>

    <h1>Insert the image converted for UTFT</h1>

    <label for="imgCode">Image Code:</label>
    <textarea type="text" id="imgCode" name="imgCode" cols="200" rows="20"></textarea><br><br>
    <button type="button" onclick="convAll()">Convert all data!</button><br><br>
    <label for="imgComp">Image With Compression:</label>
    <textarea type="text" id="imgComp" name="imgComp" cols="200" rows="20"></textarea><br><br>

    <p>Insert the image code like this:<br>
        0x0000,0x2839,0x0189,0xh123[...]</p>

    <p id="imgDetails"></p>

</body>

</html>
<script>

    function isWhatPercentOf(numA, numB) {
        return (numA / numB) * 100;
    }

    function convAll() {


        var imageData = document.getElementById("imgCode").value;
        imageData = imageData.replace(/ /g, '');
        imageData = imageData.split(",");
        for (var i = imageData.length - 1; i > 0; i--) {
            if (imageData[i].includes('/')) {
                imageData[i] = imageData[i].substr(imageData[i].length - 6);
            }
        }

        imageData.pop();

        var newImageData = "";
        var Count = 0;

        for (var i = 0; i < imageData.length - 1; i++) {
            var antes = imageData[i + Count];
            try {
                while (imageData[i + Count].includes(antes)) {
                    Count++;
                }
            }
            catch (error) {

            }
            i += Count;
            newImageData += antes + "," + Count.toString() + ",";
            Count = 0;
        }

        document.getElementById("imgComp").value = newImageData;
        newImageData = newImageData.split(',');
        newImageData.pop();
        var olderL = imageData.length;
        var newL = newImageData.length;
        document.getElementById("imgDetails").innerHTML = "Last image size: " + imageData.length + " bytes - New image size: " + newImageData.length + " bytes, Reduzing the image in " + (imageData.length - newImageData.length) + " bytes or " + (100 - isWhatPercentOf(newImageData.length, imageData.length)).toFixed(2) + "%";
        newImageData = [];
        imageData = [];

    }
</script>